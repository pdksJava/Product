<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://jboss.com/products/seam/taglib" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j" template="/layout/template.xhtml">
	<ui:define name="title">
		<h:outputText value="#{ortakIslemler.getMenuAdi('holdingKalanIzin')}" />
	</ui:define>
	<ui:define name="body">


		<h:form id="formHoldingKalanIzin" acceptcharset="UTF-8">
			<rich:panel header="#{ortakIslemler.getMenuUserAdi(holdingKalanIzinHome.session,'holdingKalanIzin')}">
				<a4j:outputPanel id="giris">
					<h:panelGrid columns="2" id="secim">
						<s:decorate template="/layout/edit.xhtml">
							<ui:define name="label">Adı </ui:define>
							<h:inputText value="#{holdingKalanIzinHome.aramaSecenekleri.ad}" size="35" />
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml">
							<ui:define name="label">Soyadı </ui:define>
							<h:inputText value="#{holdingKalanIzinHome.aramaSecenekleri.soyad}" size="35" />
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml">
							<ui:define name="label">#{ortakIslemler.personelNoAciklama()} </ui:define>
							<h:inputText value="#{holdingKalanIzinHome.aramaSecenekleri.sicilNo}" size="10">
								<a4j:support event="onchange" ajaxSingle="true" reRender="sirketId" />
							</h:inputText>
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml" id="sirketId" rendered="#{authenticatedUser.admin or authenticatedUser.IK}">
							<ui:define name="label">#{ortakIslemler.sirketAciklama()}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.sirketId}"
								required="#{(holdingKalanIzinHome.aramaSecenekleri.sicilNo == null or holdingKalanIzinHome.aramaSecenekleri.sicilNo == '') and not empty holdingKalanIzinHome.aramaSecenekleri.sirketIdList}"
								requiredMessage="#{ortakIslemler.sirketAciklama()} seçiniz!">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.sirketIdList}" />
 								<a4j:support event="onchange" action="#{holdingKalanIzinHome.fillTesisList()}" ajaxSingle="true" reRender="secim" />
							</h:selectOneMenu>
						</s:decorate>

						<s:decorate template="/layout/edit.xhtml"
							rendered="#{ortakIslemler.tesisDurumu and (authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.tesisList != null and not empty holdingKalanIzinHome.aramaSecenekleri.tesisList}">
							<ui:define name="label">#{ortakIslemler.tesisAciklama()}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.tesisId}">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.tesisList}" />
								<a4j:support event="onchange" action="#{holdingKalanIzinHome.fillEkSahaList()}" ajaxSingle="true" reRender="secim" />
							</h:selectOneMenu>
						</s:decorate>

						<s:decorate template="/layout/edit.xhtml"
							rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha1 != null}">
							<ui:define name="label">#{holdingKalanIzinHome.aramaSecenekleri.ekSaha1.aciklama}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha1Id}">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.getSelectEkSahaList('ekSaha1')}" />
							</h:selectOneMenu>
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml"
							rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha2 != null}">
							<ui:define name="label">#{holdingKalanIzinHome.aramaSecenekleri.ekSaha2.aciklama}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha2Id}">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.getSelectEkSahaList('ekSaha2')}" />
							</h:selectOneMenu>
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml"
							rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha3 != null}">
							<ui:define name="label">#{holdingKalanIzinHome.aramaSecenekleri.ekSaha3.aciklama}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha3Id}">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.getSelectEkSahaList('ekSaha3')}" />
							</h:selectOneMenu>
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml"
							rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha4 != null}">
							<ui:define name="label">#{holdingKalanIzinHome.aramaSecenekleri.ekSaha4.aciklama}</ui:define>
							<h:selectOneMenu value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha4Id}">
								<f:selectItem itemLabel="Lütfen seçiniz" />
								<f:selectItems value="#{holdingKalanIzinHome.aramaSecenekleri.getSelectEkSahaList('ekSaha4')}" />
							</h:selectOneMenu>
						</s:decorate>


						<s:decorate id="baslangicField" template="/layout/edit.xhtml" rendered="#{authenticatedUser.admin or authenticatedUser.IK }">
							<ui:define name="label">Tarihi</ui:define>
							<rich:calendar id="startDate" value="#{holdingKalanIzinHome.hakedisTarihi}" datePattern="#{authenticatedUser.dateFormat}" cellWidth="24px"
								cellHeight="22px" style="width:200px">
								<a4j:support event="onchanged" ajaxSingle="true" status="ajaxStatus" reRender="baslangicField" />
							</rich:calendar>
						</s:decorate>
						<s:decorate template="/layout/edit.xhtml" rendered="#{authenticatedUser.admin or authenticatedUser.IK}">
							<ui:define name="label">İşten Ayrılanları Getir</ui:define>
							<h:selectBooleanCheckbox value="#{holdingKalanIzinHome.istenAyrilanEkle}">
								<a4j:support event="onclick" status="ajaxStatus" ajaxSingle="true" reRender="baslangicField" />
							</h:selectBooleanCheckbox>
						</s:decorate>


					</h:panelGrid>
				</a4j:outputPanel>
			</rich:panel>
			<rich:panel>
				<a4j:outputPanel id="izinPanel">
					<ui:fragment>
						<ui:fragment rendered="#{authenticatedUser.admin or authenticatedUser.IK}">
							<a4j:commandButton value="Göster" status="ajaxStatus" action="#{holdingKalanIzinHome.fillIzinList()}" reRender="izinPanel" />
							<h:commandLink value="#{messages['ortak.etiket.excelAktar']}" action="#{holdingKalanIzinHome.izinKartiExcelAktar()}"
								rendered="#{not empty holdingKalanIzinHome.holdingIzinList}" target="blank">
								<a4j:support event="oncomplete" status="ajaxStatus" />
							</h:commandLink>
						</ui:fragment>


					</ui:fragment>
					<DIV class="#{authenticatedUser.scroolClass}" id="#{authenticatedUser.scroolDiv}">
						<rich:dataTable rowClasses="acik,koyu" value="#{holdingKalanIzinHome.holdingIzinList}" var="izinler" rows="50" rowKeyVar="row" id="izinTable"
							rendered="#{not empty holdingKalanIzinHome.holdingIzinList}">
							<f:facet name="header">
								<h:outputText value="Personeller İzinleri" />
							</f:facet>


							<rich:column rendered="#{holdingKalanIzinHome.aramaSecenekleri.sirket == null}">
								<f:facet name="header">
									<h:outputText value="#{ortakIslemler.sirketAciklama()}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.sirket.ad}" />
							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="#{ortakIslemler.personelNoAciklama()}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.sicilNo}" />
							</rich:column>

							<rich:column filterBy="#{izinler.personel.adSoyad}" filterEvent="onkeyup">
								<f:facet name="header">
									<h:outputText value="Adı Soyadı" />
								</f:facet>
								<h:outputText value="#{izinler.personel.adSoyad}" />
							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="#{ortakIslemler.kidemBasTarihiAciklama()}" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.dateFormatla(izinler.personel.izinHakEdisTarihi)}" />
							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="Doğum Tarihi" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.dateFormatla(izinler.personel.dogumTarihi)}" />
							</rich:column>
							<rich:column rendered="#{holdingKalanIzinHome.istenAyrilanEkle}" style="text-align:center">
								<f:facet name="header">
									<h:outputText value="İşten Ayrılma Tarihi" />
								</f:facet>
								<ui:fragment rendered="#{izinler.personel.isCalisiyorGun(holdingKalanIzinHome.hakedisTarihi) == false}">
									<h:outputText value="#{authenticatedUser.dateFormatla(izinler.personel.istenAyrilisTarihi)}" />
								</ui:fragment>
							</rich:column>

							<rich:column rendered="#{ortakIslemler.getListTesisDurum(holdingKalanIzinHome.holdingIzinList)}">
								<f:facet name="header">
									<h:outputText value="#{ortakIslemler.tesisAciklama()}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.tesis.aciklama}" />
							</rich:column>

							<rich:column filterBy="#{izinler.personel.ekSaha3.aciklama}" filterEvent="onkeyup">
								<f:facet name="header">
									<h:outputText value="#{holdingKalanIzinHome.bolumAciklama}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.ekSaha3.aciklama}" />
							</rich:column>


							<rich:column
								rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha1 != null and ortakIslemler.getListEkSahaDurum(holdingKalanIzinHome.holdingIzinList,'1')}">
								<f:facet name="header">
									<h:outputText value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha1.aciklama}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.ekSaha1.aciklama}" />
							</rich:column>
							<rich:column
								rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha2 != null and ortakIslemler.getListEkSahaDurum(holdingKalanIzinHome.holdingIzinList,'2')}">
								<f:facet name="header">
									<h:outputText value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha2.aciklama}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.ekSaha2.aciklama}" />
							</rich:column>
							<rich:column
								rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha3 != null and ortakIslemler.getListEkSahaDurum(holdingKalanIzinHome.holdingIzinList,'4')}">
								<f:facet name="header">
									<h:outputText value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha3.aciklama}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.ekSaha3.aciklama}" />
							</rich:column>
							<rich:column
								rendered="#{(authenticatedUser.admin or authenticatedUser.IKAdmin) and holdingKalanIzinHome.aramaSecenekleri.ekSahaTanimMap.ekSaha4 != null and holdingKalanIzinHome.aramaSecenekleri.sirket.departman.admin}">
								<f:facet name="header">
									<h:outputText value="#{holdingKalanIzinHome.aramaSecenekleri.ekSaha4.aciklama}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.ekSaha4.aciklama}" />
							</rich:column>

							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{ortakIslemler.yoneticiAciklama()}" />
								</f:facet>
								<h:outputText value="#{izinler.personel.pdksYonetici.adSoyad}" />
							</rich:column>


							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="Geçen Yıl Bakiye" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.sayiFormatliGoster(izinler.gecenYilBakiye)} Gün" rendered="#{izinler.gecenYilBakiye ne 0}" />
							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="Bu Yıl Hakkedilen" />
								</f:facet>
								<ui:fragment rendered="#{izinler.buYilHakedilen ne 0}">
									<h:outputText value="#{authenticatedUser.sayiFormatliGoster(izinler.buYilHakedilen)} Gün" rendered="#{izinler.buYilHakedilen ne 0}" />
								</ui:fragment>
								<ui:fragment rendered="#{izinler.buYilHakedilen == 0}">  
									<DIV id="denk#{izinler.personel.id}">
										<h:graphicImage value="/img/msgerror.png" style="border:0" height="20" width="20" />
									</DIV>
									<rich:toolTip for="denk#{izinler.personel.id}">
										<span style="color: red; font-style: 14;">#{authenticatedUser.dateFormatla(izinler.seciliYilIzinHakEdisTarihi)}</span>
									</rich:toolTip>
								</ui:fragment>

							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="Bu Yıl Harcanan İzin Toplamı" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.sayiFormatliGoster(izinler.harcananIzin)} Gün" rendered="#{izinler.harcananIzin ne 0}" />
							</rich:column>
							<rich:column style="text-align:center">
								<f:facet name="header">
									<h:outputText value="Bakiye İzin Toplamı" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.sayiFormatliGoster(izinler.bakiye)} Gün" rendered="#{izinler.bakiye ne 0}" />
							</rich:column>
							<rich:column style="text-align:center" rendered="#{holdingKalanIzinHome.suaVar}">
								<f:facet name="header">
									<h:outputText value="Bakiye İzin Toplamı" />
								</f:facet>
								<h:outputText value="#{authenticatedUser.sayiFormatliGoster(izinler.buYilHakedilenSua)} Gün" rendered="#{izinler.buYilHakedilenSua ne 0}" />
							</rich:column>

							<f:facet name="footer">
								<rich:datascroller renderIfSinglePage="false" maxPages="5" />
							</f:facet>
						</rich:dataTable>
					</DIV>
					<ui:fragment rendered="#{not empty holdingKalanIzinHome.holdingIzinList}">
						<SCRIPT>
									tableScroll("#{authenticatedUser.scroolDiv}",700);
	 							</SCRIPT>



					</ui:fragment>

				</a4j:outputPanel>


			</rich:panel>


		</h:form>


	</ui:define>

</ui:composition>



